(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8e1fac36"],{"269a":function(t,e,s){},"984f":function(t,e,s){"use strict";s.r(e);var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("loading",{attrs:{active:t.isLoading},on:{"update:active":function(e){t.isLoading=e}}}),s("div",{staticClass:"my-5 row justify-content-center"},[null!=t.order.products?s("form",{staticClass:"col-lg-6",on:{"~submit":function(e){return e.preventDefault(),t.payOrder(e)}}},[s("table",{staticClass:"table"},[t._m(0),s("tbody",t._l(t.order.products,(function(e){return s("tr",{key:e.id},[s("td",{staticClass:"align-middle"},[t._v(t._s(e.product.title))]),s("td",{staticClass:"align-middle"},[t._v(t._s(e.qty)+" / 件")]),s("td",{staticClass:"align-middle text-right"},[t._v(t._s(t._f("currency")(e.final_total)))])])})),0),s("tfoot",[s("tr",[s("td",{staticClass:"text-right",attrs:{colspan:"2"}},[t._v("總計")]),s("td",{staticClass:"text-right"},[t._v(t._s(t._f("currency")(t.order.total)))])])])]),s("table",{staticClass:"table"},[s("tbody",[s("tr",[s("th",{attrs:{width:"100"}},[t._v("Email")]),s("td",[t._v(t._s(t.order.user.email))])]),s("tr",[s("th",[t._v("姓名")]),s("td",[t._v(t._s(t.order.user.name))])]),s("tr",[s("th",[t._v("收件人電話")]),s("td",[t._v(t._s(t.order.user.tel))])]),s("tr",[s("th",[t._v("收件人地址")]),s("td",[t._v(t._s(t.order.user.address))])]),s("tr",[s("th",[t._v("付款狀態")]),s("td",[t.order.is_paid?s("span",{staticClass:"text-success"},[t._v("付款完成")]):s("span",[t._v("尚未付款")])])])])]),t.coupon.code?s("div",{staticClass:"getCoupon h6 my-3 mb-5"},[t._v("\n        恭喜您獲得"),s("span",{staticClass:"text-danger"},[t._v(t._s(t.coupon.percent))]),t._v("折優惠代碼"),s("br"),t._v("請於下次購物時輸入此優惠代碼：\n        "),s("span",{staticClass:"text-primary"},[t._v(t._s(t.coupon.code))]),t._v("，即可享有折扣優惠！\n      ")]):t._e(),s("div",{staticClass:"text-center"},[t.order.is_paid?s("router-link",{attrs:{to:"/"}},[t._v("返回首頁 繼續購物")]):t._e()],1),!1===t.order.is_paid?s("div",{staticClass:"text-right"},["orderLoading"!=t.status.loading?s("button",{staticClass:"btn btn-danger"},[t._v("\n          確認付款\n        ")]):t._e(),"orderLoading"==t.status.loading?s("div",["orderLoading"==t.status.loading?s("i",{staticClass:"fas fa-spinner fa-pulse"}):t._e(),t._v("\n          付款中，請勿關閉或離開此頁面\n        ")]):t._e()]):t._e()]):t._e(),null==t.order.products?s("div",{staticClass:"h5 col-md-7 mt-5 text-left text-danger"},[t._v("訂單編號："+t._s(t.orderId)+"不存在")]):t._e(),null==t.order.products?s("div",{staticClass:"col-md-7 text-left"},[s("router-link",{attrs:{to:"/"}},[t._v("返回首頁")])],1):t._e()])],1)},a=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("thead",[s("th",[t._v("品名")]),s("th",[t._v("數量")]),s("th",[t._v("單價")])])}],o={data:function(){return{orderId:"",order:{user:{},is_paid:""},isLoading:!1,status:{loading:""},coupon:{code:"",percent:""},coupons:[{code:"coxns",percent:9.9},{code:"fql5mm",percent:9.5},{code:"rgtofr",percent:9},{code:"z7ucfk",percent:8.8},{code:"dqgpmm",percent:8.5},{code:"zyv87",percent:8},{code:"puw3lk",percent:9.9},{code:"mu542",percent:9.9},{code:"0e2ty",percent:7.5}]}},methods:{getOrder:function(){var t=this,e="".concat("https://vue-course-api.hexschool.io","/api/").concat("joseph_work01","/order/").concat(t.orderId);t.isLoading=!0,this.$http.get(e).then((function(e){console.log("getOrder",e.data),null!=e.data.order?t.order=e.data.order:t.$bus.$emit("message:push","此訂單編號不存在，請重新搜尋","danger"),t.isLoading=!1}))},payOrder:function(){var t=this,e=this,s="".concat("https://vue-course-api.hexschool.io","/api/").concat("joseph_work01","/pay/").concat(e.orderId);e.status.loading="orderLoading",this.$http.post(s).then((function(s){if(console.log("getOrder",s.data),s.data.success){e.order.is_paid=s.data.is_paid,e.$bus.$emit("message:push",s.data.message,"success");var r=Math.floor(9*Math.random());t.coupon.code=t.coupons[r].code,t.coupon.percent=t.coupons[r].percent}else e.$bus.$emit("message:push",s.data.message,"danger");e.getOrder(),e.status.loading=""}))}},created:function(){this.orderId=this.$route.params.userorderId,this.getOrder()},beforeRouteLeave:function(t,e,s){if(null!=this.order.products)if(this.order.is_paid)s();else{var r=confirm("您尚未結帳完成此筆交易，\n您的訂單編號是：".concat(this.orderId,"\n日後可利用上方導航欄之搜尋功能\n選擇搜尋訂單功能並輸入此訂單號碼\n即可取回此筆訂單並完成付款！\n謝謝您的選購！"));r?(alert("請記下/複製您的訂單編號：".concat(this.orderId)),s()):s(!1)}else s()}},n=o,d=(s("ffcb"),s("2877")),c=Object(d["a"])(n,r,a,!1,null,"4c0d041c",null);e["default"]=c.exports},ffcb:function(t,e,s){"use strict";var r=s("269a"),a=s.n(r);a.a}}]);
//# sourceMappingURL=chunk-8e1fac36.a01c1555.js.map